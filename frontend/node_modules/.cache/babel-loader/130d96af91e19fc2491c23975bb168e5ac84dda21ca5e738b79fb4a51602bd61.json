{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mfauz\\\\Documents\\\\TicTacToe\\\\frontend\\\\src\\\\components\\\\Board.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport Cell from \"./Cell\";\nimport { calculateWinner } from \"../utils/helpers\";\nimport { getAIMove } from \"../utils/ai\";\nimport { Box, Typography, Button, CircularProgress\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\n} from \"@mui/material\";\nimport { useTheme } from \"@mui/system\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Board = ({\n  boardSize,\n  isAI,\n  aiDifficulty,\n  isTimerEnabled,\n  timeDuration,\n  gameMode\n}) => {\n  _s();\n  const [board, setBoard] = useState(Array.from({\n    length: boardSize\n  }, () => Array(boardSize).fill(\"\")));\n  const navigate = useNavigate();\n  const configurationBoard = () => {\n    // If game is over or board is empty, reset the board\n    navigate(\"/game\");\n  };\n  const [winner, setWinner] = useState(null);\n  const [isDraw, setIsDraw] = useState(false);\n  const [timeLeft, setTimeLeft] = useState(timeDuration);\n  //const setTimeLeft = useState<number>;\n  const [isTimerActive, setIsTimerActive] = useState(false);\n  const [isMatchmaking, setIsMatchmaking] = useState(false);\n  const [matchId, setMatchId] = useState(null);\n  const [opponent, setOpponent] = useState(null);\n  const [matchStatus, setMatchStatus] = useState(null);\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const theme = useTheme();\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [moves, setMoves] = useState([]);\n  const [isPlayerTurn, setIsPlayerTurn] = useState(false);\n  const [playerSymbol, setPlayerSymbol] = useState(\"X\");\n  const [opponentSymbol, setOpponentSymbol] = useState(\"O\");\n  const [currentPlayer, setCurrentPlayer] = useState(\"X\");\n  const timeoutPollingInterval = useRef(null);\n  const pollingInterval = useRef(null);\n  const username = sessionStorage.getItem(\"TicTacToeUsername\");\n  const [isLoading, setIsLoading] = useState(false);\n  useEffect(() => {\n    resetBoard();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [boardSize, isAI, aiDifficulty, isTimerEnabled, timeLeft, gameMode]);\n  useEffect(() => {\n    if (isTimerActive && timeLeft > 0) {\n      const timer = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);\n      return () => clearTimeout(timer);\n    } else if (isTimerActive && timeLeft === 0) {\n      handleTimeOut();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isTimerActive, timeLeft]);\n  useEffect(() => {\n    if (gameMode === \"online\" && matchId && matchStatus === \"active\") {\n      startPollingMatchState();\n      // Start polling for timeout\n      startPollingTimeout();\n    } else {\n      stopPollingMatchState();\n      stopPollingTimeout();\n    }\n    // Cleanup on unmount\n    return () => {\n      stopPollingMatchState();\n      stopPollingTimeout();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [gameMode, matchId, matchStatus]);\n  useEffect(() => {\n    if (!winner && !isDraw) {\n      if (gameMode === \"online\" || gameMode === \"local\") {\n        // For online and local modes, reset timer when turn changes\n        setTimeLeft(timeLeft);\n        setIsTimerActive(true);\n      } else if (gameMode === \"ai\" && isAI && currentPlayer === \"X\") {\n        // For AI mode, reset timer when it's the player's turn\n        setTimeLeft(timeLeft);\n        setIsTimerActive(true);\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isPlayerTurn, currentPlayer]);\n  useEffect(() => {\n    const handleBeforeUnload = e => {\n      const url = \"https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/matchmaking/cancel\";\n      fetch(url, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`\n        },\n        body: JSON.stringify({\n          player: username\n        }),\n        keepalive: true\n      }).catch(error => {\n        console.error(\"Error canceling matchmaking:\", error);\n      });\n      e.preventDefault();\n      e.returnValue = \"\";\n    };\n    window.addEventListener(\"beforeunload\", handleBeforeUnload);\n\n    // Cleanup\n    return () => {\n      window.removeEventListener(\"beforeunload\", handleBeforeUnload);\n    };\n  }, [winner, isDraw, board, matchStatus, gameMode, isMatchmaking, username]);\n  const handleTimeOut = () => {\n    if (winner || isDraw) return;\n    if (gameMode === \"ai\" && isAI) {\n      setWinner(\"AI wins due to timeout!\");\n      handleAIMatchResult(\"loss\");\n    } else if (gameMode === \"online\") {\n      // Handle timeout in PvP\n      setWinner(opponent === null ? \"\" : `${opponent} wins due to timeout!`);\n      handlePVPMatchResult(opponent);\n      stopPollingMatchState();\n      stopPollingTimeout();\n    } else {\n      setWinner(`${isPlayerTurn ? \"Player 2\" : \"Player 1\"} wins due to timeout!`);\n    }\n    setIsTimerActive(false);\n  };\n\n  // 3 cases: play online PvP, play against AI, play locally PvP\n  const handleCellClick = (row, col) => {\n    if (board[row][col] || winner) return;\n    if (gameMode === \"online\") {\n      if (!isPlayerTurn) return;\n      setIsLoading(true);\n      syncMove(row, col);\n    } else if (isAI && gameMode === \"ai\") {\n      // AI Mode logic\n      if (currentPlayer !== \"X\") return;\n      const updatedBoard = board.map((r, i) => r.map((cell, j) => i === row && j === col ? currentPlayer : cell));\n      setBoard(updatedBoard);\n      const gameWinner = calculateWinner(updatedBoard);\n      if (gameWinner) {\n        const resultMessage = gameWinner === \"X\" ? \"Player X wins!\" : \"Player O wins!\";\n        setWinner(resultMessage);\n        handleAIMatchResult(gameWinner === \"X\" ? \"win\" : \"loss\");\n        setIsTimerActive(false);\n        return;\n      }\n      if (isBoardFull(updatedBoard)) {\n        setIsDraw(true);\n        handleAIMatchResult(\"draw\");\n        setIsTimerActive(false);\n        return;\n      }\n      setCurrentPlayer(\"O\");\n      setTimeLeft(timeLeft);\n\n      // AI's turn\n      setTimeout(() => {\n        const aiMove = getAIMove(updatedBoard, aiDifficulty);\n        if (aiMove) {\n          const aiUpdatedBoard = updatedBoard.map((r, i) => r.map((cell, j) => i === aiMove.row && j === aiMove.col ? \"O\" : cell));\n          setBoard(aiUpdatedBoard);\n          const aiWinner = calculateWinner(aiUpdatedBoard);\n          if (aiWinner) {\n            setWinner(\"AI wins!\");\n            handleAIMatchResult(\"loss\"); // Player loses to AI\n            setIsTimerActive(false);\n            return;\n          }\n          if (isBoardFull(aiUpdatedBoard)) {\n            setIsDraw(true);\n            handleAIMatchResult(\"draw\"); // Draw condition\n            setIsTimerActive(false);\n            return;\n          }\n          setCurrentPlayer(\"X\");\n          setTimeLeft(timeLeft);\n        }\n      }, 300);\n    } else if (gameMode === \"local\") {\n      // Local game\n      const symbol = isPlayerTurn ? playerSymbol : opponentSymbol;\n      const updatedBoard = board.map((r, i) => r.map((cell, j) => i === row && j === col ? symbol : cell));\n      setBoard(updatedBoard);\n      const gameWinner = calculateWinner(updatedBoard);\n      if (gameWinner) {\n        const resultMessage = gameWinner === playerSymbol ? \"Player 1 wins!\" : \"Player 2 wins!\";\n        setWinner(resultMessage);\n        setIsTimerActive(false);\n        return;\n      }\n      if (isBoardFull(updatedBoard)) {\n        setIsDraw(true);\n        setIsTimerActive(false);\n        return;\n      }\n      setIsPlayerTurn(!isPlayerTurn);\n      setTimeLeft(timeLeft);\n    }\n  };\n  const handleAIMatchResult = async result => {\n    if (!username) return;\n    try {\n      const response = await fetch(\"https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/ai-match\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`\n        },\n        body: JSON.stringify({\n          player: username,\n          result,\n          difficulty: aiDifficulty\n        })\n      });\n      if (!response.ok) {\n        console.error(\"Failed to update leaderboard:\", await response.json());\n      }\n    } catch (error) {\n      console.error(\"Error updating leaderboard:\", error);\n    }\n  };\n  const handlePVPMatchResult = async winnerUsername => {\n    if (!matchId || !username) return;\n    try {\n      const response = await fetch(\"https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/match/finish\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`\n        },\n        body: JSON.stringify({\n          matchId,\n          winner: winnerUsername\n        })\n      });\n      if (!response.ok) {\n        console.error(\"Failed to finish match:\", await response.json());\n      }\n    } catch (error) {\n      console.error(\"Error finishing match:\", error);\n    }\n  };\n  const isBoardFull = board => {\n    return board.every(row => row.every(cell => cell !== \"\"));\n  };\n  const resetBoard = () => {\n    // If game is over or board is empty, reset the board\n    setBoard(Array.from({\n      length: boardSize\n    }, () => Array(boardSize).fill(\"\")));\n    setWinner(null);\n    setIsDraw(false);\n    setTimeLeft(timeDuration);\n    setIsTimerActive(true);\n    setIsMatchmaking(false);\n    setMatchId(null);\n    setOpponent(null);\n    setMatchStatus(null);\n    setMoves([]);\n    setIsPlayerTurn(true);\n    setPlayerSymbol(\"X\");\n    setOpponentSymbol(\"O\");\n    setCurrentPlayer(\"X\");\n    stopPollingMatchState();\n    stopPollingTimeout();\n  };\n  const startMatchmaking = async () => {\n    const token = sessionStorage.getItem(\"token\");\n    if (!token || !username) {\n      alert(\"You must be logged in to start matchmaking with another player.\");\n      setIsMatchmaking(false);\n      return;\n    }\n    setIsMatchmaking(true);\n    try {\n      const response = await fetch(\"https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/matchmaking\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`\n        },\n        body: JSON.stringify({\n          player: username\n        })\n      });\n      const data = await response.json();\n      if (response.status === 200) {\n        // Match found immediately\n        setMatchId(data.matchId);\n        setOpponent(data.opponent);\n        setMatchStatus(\"active\");\n\n        // Determine symbols based on who was the first player\n        if (data.player === username) {\n          // You are the first player\n          setPlayerSymbol(\"X\");\n          setOpponentSymbol(\"O\");\n          setIsPlayerTurn(true);\n        } else {\n          // You are the second player\n          setPlayerSymbol(\"O\");\n          setOpponentSymbol(\"X\");\n          setIsPlayerTurn(false);\n        }\n        alert(\"Match found! Opponent: \" + data.opponent);\n      } else if (response.status === 202) {\n        // Searching for opponent\n        setMatchStatus(\"waiting\");\n        setPlayerSymbol(\"X\");\n        setOpponentSymbol(\"O\");\n        setIsPlayerTurn(true);\n        checkMatchmakingStatus();\n      } else if (response.status === 401) {\n        alert(\"You must be logged in to start matchmaking.\");\n        setIsMatchmaking(false);\n        return;\n      } else {\n        console.error(\"Matchmaking error:\", data);\n        setIsMatchmaking(false);\n      }\n    } catch (error) {\n      console.error(\"Matchmaking error:\", error);\n      setIsMatchmaking(false);\n    }\n  };\n  const checkMatchmakingStatus = async () => {\n    try {\n      const response = await fetch(`https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/matchmaking/status?player=${username}`, {\n        headers: {\n          Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`\n        }\n      });\n      const data = await response.json();\n      if (response.ok) {\n        if (data.matchId) {\n          // Match found\n          setMatchId(data.matchId);\n          setOpponent(data.opponent);\n          setMatchStatus(\"active\");\n\n          // Symbols and turn have already been set when matchmaking started\n          alert(\"Match found! Opponent: \" + data.opponent);\n        } else if (data.message === \"Still searching for an opponent...\") {\n          setTimeout(checkMatchmakingStatus, 2000);\n        } else {\n          setIsMatchmaking(false);\n          alert(\"No matchmaking in progress.\");\n        }\n      } else {\n        console.error(\"Error checking matchmaking status:\", data);\n        setIsMatchmaking(false);\n      }\n    } catch (error) {\n      console.error(\"Error checking matchmaking status:\", error);\n      setIsMatchmaking(false);\n    }\n  };\n  const fetchMatchState = async () => {\n    if (!matchId) return;\n    try {\n      const response = await fetch(`https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/match/state?matchId=${matchId}`, {\n        headers: {\n          Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`\n        }\n      });\n      const data = await response.json();\n      if (response.ok) {\n        setMoves(data.moves);\n        setMatchStatus(data.status);\n        updateBoardFromMoves(data.moves);\n\n        // Determine if it's the player's turn based on the number of moves\n        const totalMoves = data.moves.length;\n        const isMyTurn = totalMoves % 2 === 0 && playerSymbol === \"X\" || totalMoves % 2 === 1 && playerSymbol === \"O\";\n        setIsPlayerTurn(isMyTurn);\n        if (data.winner) {\n          setWinner(data.winner === username ? \"You win!\" : `${opponent} wins!`);\n          stopPollingMatchState();\n          stopPollingTimeout();\n          setIsTimerActive(false);\n        } else if (data.status === \"complete\") {\n          setIsDraw(true);\n          stopPollingMatchState();\n          stopPollingTimeout();\n          setIsTimerActive(false);\n        }\n      } else {\n        console.error(\"Error fetching match state:\", data);\n      }\n    } catch (error) {\n      console.error(\"Error fetching match state:\", error);\n    }\n  };\n  const updateBoardFromMoves = moves => {\n    const newBoard = Array.from({\n      length: boardSize\n    }, () => Array(boardSize).fill(\"\"));\n    moves.forEach(move => {\n      const symbol = move.player === username ? playerSymbol : opponentSymbol;\n      newBoard[move.move.row][move.move.column] = symbol;\n    });\n    setBoard(newBoard);\n    const gameWinner = calculateWinner(newBoard);\n    if (gameWinner) {\n      const winnerUsername = gameWinner === playerSymbol ? username : opponent;\n      setWinner(winnerUsername === username ? \"You win!\" : `${opponent} wins!`);\n      handlePVPMatchResult(winnerUsername);\n      stopPollingMatchState();\n      stopPollingTimeout();\n      setIsTimerActive(false);\n    } else if (isBoardFull(newBoard)) {\n      setIsDraw(true);\n      handlePVPMatchResult(\"draw\");\n      stopPollingMatchState();\n      stopPollingTimeout();\n      setIsTimerActive(false);\n    }\n  };\n  const syncMove = async (row, col) => {\n    if (!matchId || !username) {\n      setIsLoading(false);\n      return;\n    }\n    try {\n      const response = await fetch(\"https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/match/move\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`\n        },\n        body: JSON.stringify({\n          matchId,\n          player: username,\n          move: {\n            row,\n            column: col\n          }\n        })\n      });\n      const data = await response.json();\n      if (response.ok) {\n        fetchMatchState();\n      } else {\n        console.error(\"Error syncing move:\", data);\n        alert(data.error || \"Error syncing move\");\n      }\n    } catch (error) {\n      console.error(\"Error syncing move:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleMatchTimeout = async () => {\n    if (!matchId || !username) return;\n    try {\n      const response = await fetch(\"https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/match/timeout\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`\n        },\n        body: JSON.stringify({\n          matchId,\n          player: username\n        })\n      });\n      const data = await response.json();\n      if (response.ok) {\n        if (data.winner) {\n          setWinner(data.winner === null ? \"Match ended due to timeout - Please try again\" : data.winner === username ? \"You win by timeout!\" : `${opponent} wins by timeout!`);\n          handlePVPMatchResult(data.winner);\n          stopPollingMatchState();\n          stopPollingTimeout();\n          setIsTimerActive(false);\n        }\n      } else {\n        console.error(\"Error checking timeout:\", data);\n      }\n    } catch (error) {\n      console.error(\"Error checking timeout:\", error);\n    }\n  };\n\n  // Function to start polling for timeout\n  const startPollingTimeout = () => {\n    if (timeoutPollingInterval.current) return;\n    timeoutPollingInterval.current = setInterval(handleMatchTimeout, 5000);\n  };\n  const stopPollingTimeout = () => {\n    if (timeoutPollingInterval.current) {\n      clearInterval(timeoutPollingInterval.current);\n      timeoutPollingInterval.current = null;\n    }\n  };\n  const startPollingMatchState = () => {\n    if (pollingInterval.current) return;\n    pollingInterval.current = setInterval(fetchMatchState, 2000);\n  };\n  const stopPollingMatchState = () => {\n    if (pollingInterval.current) {\n      clearInterval(pollingInterval.current);\n      pollingInterval.current = null;\n    }\n  };\n\n  // Format timeLeft into MM:SS\n  const formatTime = seconds => {\n    const mins = Math.floor(seconds / 60).toString().padStart(2, \"0\");\n    const secs = (seconds % 60).toString().padStart(2, \"0\");\n    return `${mins}:${secs}`;\n  };\n\n  // Calculate progress percentage\n  const progressPercentage = timeLeft / timeLeft * 100;\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      position: \"relative\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      height: \"100%\"\n    },\n    children: [gameMode === \"online\" && !matchId && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [isMatchmaking && /*#__PURE__*/_jsxDEV(CircularProgress, {\n        sx: {\n          mb: 2\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 658,\n        columnNumber: 29\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: startMatchmaking,\n        sx: {\n          mb: 2\n        },\n        disabled: isMatchmaking,\n        children: isMatchmaking ? \"Searching for opponent...\" : \"Start Matchmaking\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 659,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true), (gameMode !== \"online\" || opponent) && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h6\",\n        sx: {\n          fontFamily: \"Poppins\",\n          mt: 2\n        },\n        children: gameMode === \"online\" && opponent ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [\"You (\", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: playerSymbol === \"X\" ? \"#1976d2\" : \"red\",\n              fontWeight: \"bold\"\n            },\n            children: playerSymbol\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 678,\n            columnNumber: 17\n          }, this), \") vs \", opponent, \" (\", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: opponentSymbol === \"X\" ? \"#1976d2\" : \"red\",\n              fontWeight: \"bold\"\n            },\n            children: opponentSymbol\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 687,\n            columnNumber: 17\n          }, this), \")\"]\n        }, void 0, true) : isAI ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [\"Player (\", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: \"#1976d2\",\n              fontWeight: \"bold\"\n            },\n            children: \"X\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 700,\n            columnNumber: 17\n          }, this), \") vs AI (\", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: \"red\",\n              fontWeight: \"bold\"\n            },\n            children: \"O\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 702,\n            columnNumber: 17\n          }, this), \")\"]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [\"Player 1 (\", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: \"#1976d2\",\n              fontWeight: \"bold\"\n            },\n            children: \"X\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 707,\n            columnNumber: 17\n          }, this), \") vs Player 2 (\", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: \"red\",\n              fontWeight: \"bold\"\n            },\n            children: \"O\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 709,\n            columnNumber: 17\n          }, this), \")\"]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 674,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h6\",\n        sx: {\n          fontFamily: \"Poppins\",\n          mt: 2\n        },\n        children: winner || isDraw ? \"Game Over\" : gameMode === \"local\" ? isPlayerTurn ? /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: \"#1976d2\"\n            },\n            children: \"X\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 719,\n            columnNumber: 19\n          }, this), \"'s Turn\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 718,\n          columnNumber: 17\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: \"red\"\n            },\n            children: \"O\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 723,\n            columnNumber: 19\n          }, this), \"'s Turn\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 722,\n          columnNumber: 17\n        }, this) : isPlayerTurn ? \"Your Turn\" : gameMode === \"online\" ? `${opponent}'s Turn` : isAI ? \"AI's Turn\" : \"Opponent's Turn\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 713,\n        columnNumber: 11\n      }, this), isTimerActive && !winner && !isDraw && /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          position: \"relative\",\n          display: \"inline-flex\",\n          mt: 2\n        },\n        children: [/*#__PURE__*/_jsxDEV(CircularProgress, {\n          variant: \"determinate\",\n          value: progressPercentage,\n          size: 80,\n          thickness: 5\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 746,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            top: 0,\n            left: 0,\n            bottom: 0,\n            right: 0,\n            position: \"absolute\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h6\",\n            component: \"div\",\n            color: \"textSecondary\",\n            children: formatTime(timeLeft)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 764,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 752,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 739,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true), /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        display: \"grid\",\n        gridTemplateColumns: `repeat(${boardSize}, 1fr)`,\n        gap: \"1px\",\n        mt: 2\n      },\n      children: board.map((row, i) => row.map((cell, j) => /*#__PURE__*/_jsxDEV(Cell, {\n        value: cell,\n        onClick: () => handleCellClick(i, j)\n      }, `${i}-${j}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 783,\n        columnNumber: 13\n      }, this)))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 773,\n      columnNumber: 7\n    }, this), winner && /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h6\",\n      sx: {\n        mt: 2\n      },\n      color: \"success.main\",\n      children: winner\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 792,\n      columnNumber: 9\n    }, this), isDraw && /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h6\",\n      sx: {\n        mt: 2\n      },\n      color: \"warning.main\",\n      children: \"It's a draw!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 797,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      onClick: configurationBoard,\n      sx: {\n        margin: 2,\n        fontFamily: \"Poppins\"\n      },\n      children: \"Back to Configuration\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 802,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      onClick: resetBoard,\n      sx: {\n        margin: 2,\n        fontFamily: \"Poppins\"\n      },\n      children: \"Reset Board\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 811,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"100%\",\n        borderBottom: \"1px solid #e0e0e0\",\n        margin: \"0 auto 20px\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 821,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"body1\",\n      sx: {\n        fontFamily: \"Poppins\",\n        margin: \"20px\"\n      },\n      children: \"Please use a wide screen like a laptop or desktop for the best experience. Thank you for playing Tic Tac Toe Pro today! \\uD83D\\uDE80\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 829,\n      columnNumber: 7\n    }, this), isLoading && /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        position: \"fixed\",\n        top: 0,\n        left: 0,\n        width: \"100%\",\n        height: \"100%\",\n        backgroundColor: \"rgba(128, 128, 128, 0.5)\",\n        zIndex: 9999,\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\"\n      },\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 853,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 839,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 646,\n    columnNumber: 5\n  }, this);\n};\n_s(Board, \"iybMZmoYS+uO329kL4UYwkcUqZs=\", false, function () {\n  return [useNavigate, useTheme];\n});\n_c = Board;\nexport default Board;\nvar _c;\n$RefreshReg$(_c, \"Board\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Cell","calculateWinner","getAIMove","Box","Typography","Button","CircularProgress","useTheme","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","Board","boardSize","isAI","aiDifficulty","isTimerEnabled","timeDuration","gameMode","_s","board","setBoard","Array","from","length","fill","navigate","configurationBoard","winner","setWinner","isDraw","setIsDraw","timeLeft","setTimeLeft","isTimerActive","setIsTimerActive","isMatchmaking","setIsMatchmaking","matchId","setMatchId","opponent","setOpponent","matchStatus","setMatchStatus","theme","moves","setMoves","isPlayerTurn","setIsPlayerTurn","playerSymbol","setPlayerSymbol","opponentSymbol","setOpponentSymbol","currentPlayer","setCurrentPlayer","timeoutPollingInterval","pollingInterval","username","sessionStorage","getItem","isLoading","setIsLoading","resetBoard","timer","setTimeout","clearTimeout","handleTimeOut","startPollingMatchState","startPollingTimeout","stopPollingMatchState","stopPollingTimeout","handleBeforeUnload","e","url","fetch","method","headers","Authorization","body","JSON","stringify","player","keepalive","catch","error","console","preventDefault","returnValue","window","addEventListener","removeEventListener","handleAIMatchResult","handlePVPMatchResult","handleCellClick","row","col","syncMove","updatedBoard","map","r","i","cell","j","gameWinner","resultMessage","isBoardFull","aiMove","aiUpdatedBoard","aiWinner","symbol","result","response","difficulty","ok","json","winnerUsername","every","startMatchmaking","token","alert","data","status","checkMatchmakingStatus","message","fetchMatchState","updateBoardFromMoves","totalMoves","isMyTurn","newBoard","forEach","move","column","handleMatchTimeout","current","setInterval","clearInterval","formatTime","seconds","mins","Math","floor","toString","padStart","secs","progressPercentage","sx","position","display","flexDirection","alignItems","justifyContent","height","children","mb","fileName","_jsxFileName","lineNumber","columnNumber","variant","color","onClick","disabled","fontFamily","mt","style","fontWeight","value","size","thickness","top","left","bottom","right","component","gridTemplateColumns","gap","margin","width","borderBottom","backgroundColor","zIndex","_c","$RefreshReg$"],"sources":["C:/Users/mfauz/Documents/TicTacToe/frontend/src/components/Board.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport Cell from \"./Cell\";\nimport { calculateWinner } from \"../utils/helpers\";\nimport { getAIMove } from \"../utils/ai\";\nimport {\n  Box,\n  Typography,\n  Button,\n  CircularProgress,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  LinearProgress,\n} from \"@mui/material\";\nimport { useTheme } from \"@mui/system\";\nimport { useNavigate } from \"react-router-dom\";\n\ninterface BoardProps {\n  boardSize: number;\n  isAI: boolean;\n  aiDifficulty: string;\n  isTimerEnabled: boolean;\n  timeDuration: number;\n  gameMode: string;\n}\n\nconst Board: React.FC<BoardProps> = ({\n  boardSize,\n  isAI,\n  aiDifficulty,\n  isTimerEnabled,\n  timeDuration,\n  gameMode,\n}) => {\n  const [board, setBoard] = useState(\n    Array.from({ length: boardSize }, () => Array(boardSize).fill(\"\")),\n  );\n  const navigate = useNavigate();\n  const configurationBoard = () => {\n    // If game is over or board is empty, reset the board\n    navigate(\"/game\");\n  };\n\n  const [winner, setWinner] = useState<string | null>(null);\n  const [isDraw, setIsDraw] = useState(false);\n  const [timeLeft, setTimeLeft] = useState(timeDuration);\n  //const setTimeLeft = useState<number>;\n  const [isTimerActive, setIsTimerActive] = useState(false);\n  const [isMatchmaking, setIsMatchmaking] = useState(false);\n  const [matchId, setMatchId] = useState<string | null>(null);\n  const [opponent, setOpponent] = useState<string | null>(null);\n  const [matchStatus, setMatchStatus] = useState<\n    \"waiting\" | \"active\" | \"complete\" | null\n  >(null);\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const theme = useTheme();\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [moves, setMoves] = useState<any[]>([]);\n  const [isPlayerTurn, setIsPlayerTurn] = useState<boolean>(false);\n  const [playerSymbol, setPlayerSymbol] = useState<\"X\" | \"O\">(\"X\");\n  const [opponentSymbol, setOpponentSymbol] = useState<\"X\" | \"O\">(\"O\");\n  const [currentPlayer, setCurrentPlayer] = useState<\"X\" | \"O\">(\"X\");\n  const timeoutPollingInterval = useRef<NodeJS.Timeout | null>(null);\n  const pollingInterval = useRef<NodeJS.Timeout | null>(null);\n  const username = sessionStorage.getItem(\"TicTacToeUsername\");\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    resetBoard();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [boardSize, isAI, aiDifficulty, isTimerEnabled, timeLeft, gameMode]);\n\n  useEffect(() => {\n    if (isTimerActive && timeLeft > 0) {\n      const timer = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);\n      return () => clearTimeout(timer);\n    } else if (isTimerActive && timeLeft === 0) {\n      handleTimeOut();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isTimerActive, timeLeft]);\n\n  useEffect(() => {\n    if (gameMode === \"online\" && matchId && matchStatus === \"active\") {\n      startPollingMatchState();\n      // Start polling for timeout\n      startPollingTimeout();\n    } else {\n      stopPollingMatchState();\n      stopPollingTimeout();\n    }\n    // Cleanup on unmount\n    return () => {\n      stopPollingMatchState();\n      stopPollingTimeout();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [gameMode, matchId, matchStatus]);\n\n  useEffect(() => {\n    if (!winner && !isDraw) {\n      if (gameMode === \"online\" || gameMode === \"local\") {\n        // For online and local modes, reset timer when turn changes\n        setTimeLeft(timeLeft);\n        setIsTimerActive(true);\n      } else if (gameMode === \"ai\" && isAI && currentPlayer === \"X\") {\n        // For AI mode, reset timer when it's the player's turn\n        setTimeLeft(timeLeft);\n        setIsTimerActive(true);\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isPlayerTurn, currentPlayer]);\n\n  useEffect(() => {\n    const handleBeforeUnload = (e: BeforeUnloadEvent) => {\n      const url =\n        \"https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/matchmaking/cancel\";\n      fetch(url, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`,\n        },\n        body: JSON.stringify({ player: username }),\n        keepalive: true,\n      }).catch((error) => {\n        console.error(\"Error canceling matchmaking:\", error);\n      });\n\n      e.preventDefault();\n      e.returnValue = \"\";\n    };\n\n    window.addEventListener(\"beforeunload\", handleBeforeUnload);\n\n    // Cleanup\n    return () => {\n      window.removeEventListener(\"beforeunload\", handleBeforeUnload);\n    };\n  }, [winner, isDraw, board, matchStatus, gameMode, isMatchmaking, username]);\n\n  const handleTimeOut = () => {\n    if (winner || isDraw) return;\n\n    if (gameMode === \"ai\" && isAI) {\n      setWinner(\"AI wins due to timeout!\");\n      handleAIMatchResult(\"loss\");\n    } else if (gameMode === \"online\") {\n      // Handle timeout in PvP\n      setWinner(opponent === null ? \"\" : `${opponent} wins due to timeout!`);\n      handlePVPMatchResult(opponent!);\n      stopPollingMatchState();\n      stopPollingTimeout();\n    } else {\n      setWinner(\n        `${isPlayerTurn ? \"Player 2\" : \"Player 1\"} wins due to timeout!`,\n      );\n    }\n    setIsTimerActive(false);\n  };\n\n  // 3 cases: play online PvP, play against AI, play locally PvP\n  const handleCellClick = (row: number, col: number) => {\n    if (board[row][col] || winner) return;\n\n    if (gameMode === \"online\") {\n      if (!isPlayerTurn) return;\n      setIsLoading(true);\n      syncMove(row, col);\n    } else if (isAI && gameMode === \"ai\") {\n      // AI Mode logic\n      if (currentPlayer !== \"X\") return;\n\n      const updatedBoard = board.map((r, i) =>\n        r.map((cell, j) => (i === row && j === col ? currentPlayer : cell)),\n      );\n      setBoard(updatedBoard);\n\n      const gameWinner = calculateWinner(updatedBoard);\n      if (gameWinner) {\n        const resultMessage =\n          gameWinner === \"X\" ? \"Player X wins!\" : \"Player O wins!\";\n        setWinner(resultMessage);\n\n        handleAIMatchResult(gameWinner === \"X\" ? \"win\" : \"loss\");\n        setIsTimerActive(false);\n        return;\n      }\n\n      if (isBoardFull(updatedBoard)) {\n        setIsDraw(true);\n        handleAIMatchResult(\"draw\");\n        setIsTimerActive(false);\n        return;\n      }\n\n      setCurrentPlayer(\"O\");\n      setTimeLeft(timeLeft);\n\n      // AI's turn\n      setTimeout(() => {\n        const aiMove = getAIMove(updatedBoard, aiDifficulty);\n        if (aiMove) {\n          const aiUpdatedBoard = updatedBoard.map((r, i) =>\n            r.map((cell, j) =>\n              i === aiMove.row && j === aiMove.col ? \"O\" : cell,\n            ),\n          );\n          setBoard(aiUpdatedBoard);\n\n          const aiWinner = calculateWinner(aiUpdatedBoard);\n\n          if (aiWinner) {\n            setWinner(\"AI wins!\");\n            handleAIMatchResult(\"loss\"); // Player loses to AI\n            setIsTimerActive(false);\n            return;\n          }\n\n          if (isBoardFull(aiUpdatedBoard)) {\n            setIsDraw(true);\n            handleAIMatchResult(\"draw\"); // Draw condition\n            setIsTimerActive(false);\n            return;\n          }\n\n          setCurrentPlayer(\"X\");\n          setTimeLeft(timeLeft);\n        }\n      }, 300);\n    } else if (gameMode === \"local\") {\n      // Local game\n      const symbol = isPlayerTurn ? playerSymbol : opponentSymbol;\n      const updatedBoard = board.map((r, i) =>\n        r.map((cell, j) => (i === row && j === col ? symbol : cell)),\n      );\n      setBoard(updatedBoard);\n\n      const gameWinner = calculateWinner(updatedBoard);\n      if (gameWinner) {\n        const resultMessage =\n          gameWinner === playerSymbol ? \"Player 1 wins!\" : \"Player 2 wins!\";\n        setWinner(resultMessage);\n        setIsTimerActive(false);\n        return;\n      }\n\n      if (isBoardFull(updatedBoard)) {\n        setIsDraw(true);\n        setIsTimerActive(false);\n        return;\n      }\n\n      setIsPlayerTurn(!isPlayerTurn);\n      setTimeLeft(timeLeft);\n    }\n  };\n\n  const handleAIMatchResult = async (result: \"win\" | \"loss\" | \"draw\") => {\n    if (!username) return;\n\n    try {\n      const response = await fetch(\n        \"https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/ai-match\",\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`,\n          },\n          body: JSON.stringify({\n            player: username,\n            result,\n            difficulty: aiDifficulty,\n          }),\n        },\n      );\n\n      if (!response.ok) {\n        console.error(\"Failed to update leaderboard:\", await response.json());\n      }\n    } catch (error) {\n      console.error(\"Error updating leaderboard:\", error);\n    }\n  };\n\n  const handlePVPMatchResult = async (winnerUsername: string) => {\n    if (!matchId || !username) return;\n\n    try {\n      const response = await fetch(\n        \"https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/match/finish\",\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`,\n          },\n          body: JSON.stringify({\n            matchId,\n            winner: winnerUsername,\n          }),\n        },\n      );\n\n      if (!response.ok) {\n        console.error(\"Failed to finish match:\", await response.json());\n      }\n    } catch (error) {\n      console.error(\"Error finishing match:\", error);\n    }\n  };\n\n  const isBoardFull = (board: string[][]): boolean => {\n    return board.every((row) => row.every((cell) => cell !== \"\"));\n  };\n\n  const resetBoard = () => {\n    // If game is over or board is empty, reset the board\n    setBoard(\n      Array.from({ length: boardSize }, () => Array(boardSize).fill(\"\")),\n    );\n    setWinner(null);\n    setIsDraw(false);\n    setTimeLeft(timeDuration);\n    setIsTimerActive(true);\n    setIsMatchmaking(false);\n    setMatchId(null);\n    setOpponent(null);\n    setMatchStatus(null);\n    setMoves([]);\n    setIsPlayerTurn(true);\n    setPlayerSymbol(\"X\");\n    setOpponentSymbol(\"O\");\n    setCurrentPlayer(\"X\");\n    stopPollingMatchState();\n    stopPollingTimeout();\n  };\n\n\n  const startMatchmaking = async () => {\n    const token = sessionStorage.getItem(\"token\");\n\n    if (!token || !username) {\n      alert(\"You must be logged in to start matchmaking with another player.\");\n      setIsMatchmaking(false);\n      return;\n    }\n\n    setIsMatchmaking(true);\n\n    try {\n      const response = await fetch(\n        \"https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/matchmaking\",\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`,\n          },\n          body: JSON.stringify({\n            player: username,\n          }),\n        },\n      );\n\n      const data = await response.json();\n\n      if (response.status === 200) {\n        // Match found immediately\n        setMatchId(data.matchId);\n        setOpponent(data.opponent);\n        setMatchStatus(\"active\");\n\n        // Determine symbols based on who was the first player\n        if (data.player === username) {\n          // You are the first player\n          setPlayerSymbol(\"X\");\n          setOpponentSymbol(\"O\");\n          setIsPlayerTurn(true);\n        } else {\n          // You are the second player\n          setPlayerSymbol(\"O\");\n          setOpponentSymbol(\"X\");\n          setIsPlayerTurn(false);\n        }\n\n        alert(\"Match found! Opponent: \" + data.opponent);\n      } else if (response.status === 202) {\n        // Searching for opponent\n        setMatchStatus(\"waiting\");\n        setPlayerSymbol(\"X\");\n        setOpponentSymbol(\"O\");\n        setIsPlayerTurn(true);\n        checkMatchmakingStatus();\n      } else if (response.status === 401) {\n        alert(\"You must be logged in to start matchmaking.\");\n        setIsMatchmaking(false);\n        return;\n      } else {\n        console.error(\"Matchmaking error:\", data);\n        setIsMatchmaking(false);\n      }\n    } catch (error) {\n      console.error(\"Matchmaking error:\", error);\n      setIsMatchmaking(false);\n    }\n  };\n\n  const checkMatchmakingStatus = async () => {\n    try {\n      const response = await fetch(\n        `https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/matchmaking/status?player=${username}`,\n        {\n          headers: {\n            Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`,\n          },\n        },\n      );\n\n      const data = await response.json();\n\n      if (response.ok) {\n        if (data.matchId) {\n          // Match found\n          setMatchId(data.matchId);\n          setOpponent(data.opponent);\n          setMatchStatus(\"active\");\n\n          // Symbols and turn have already been set when matchmaking started\n          alert(\"Match found! Opponent: \" + data.opponent);\n        } else if (data.message === \"Still searching for an opponent...\") {\n          setTimeout(checkMatchmakingStatus, 2000);\n        } else {\n          setIsMatchmaking(false);\n          alert(\"No matchmaking in progress.\");\n        }\n      } else {\n        console.error(\"Error checking matchmaking status:\", data);\n        setIsMatchmaking(false);\n      }\n    } catch (error) {\n      console.error(\"Error checking matchmaking status:\", error);\n      setIsMatchmaking(false);\n    }\n  };\n\n  const fetchMatchState = async () => {\n    if (!matchId) return;\n\n    try {\n      const response = await fetch(\n        `https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/match/state?matchId=${matchId}`,\n        {\n          headers: {\n            Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`,\n          },\n        },\n      );\n\n      const data = await response.json();\n\n      if (response.ok) {\n        setMoves(data.moves);\n        setMatchStatus(data.status);\n\n        updateBoardFromMoves(data.moves);\n\n        // Determine if it's the player's turn based on the number of moves\n        const totalMoves = data.moves.length;\n        const isMyTurn =\n          (totalMoves % 2 === 0 && playerSymbol === \"X\") ||\n          (totalMoves % 2 === 1 && playerSymbol === \"O\");\n\n        setIsPlayerTurn(isMyTurn);\n\n        if (data.winner) {\n          setWinner(\n            data.winner === username ? \"You win!\" : `${opponent} wins!`,\n          );\n          stopPollingMatchState();\n          stopPollingTimeout();\n          setIsTimerActive(false);\n        } else if (data.status === \"complete\") {\n          setIsDraw(true);\n          stopPollingMatchState();\n          stopPollingTimeout();\n          setIsTimerActive(false);\n        }\n      } else {\n        console.error(\"Error fetching match state:\", data);\n      }\n    } catch (error) {\n      console.error(\"Error fetching match state:\", error);\n    }\n  };\n\n  const updateBoardFromMoves = (moves: any[]) => {\n    const newBoard = Array.from({ length: boardSize }, () =>\n      Array(boardSize).fill(\"\"),\n    );\n\n    moves.forEach((move) => {\n      const symbol = move.player === username ? playerSymbol : opponentSymbol;\n      newBoard[move.move.row][move.move.column] = symbol;\n    });\n\n    setBoard(newBoard);\n\n    const gameWinner = calculateWinner(newBoard);\n    if (gameWinner) {\n      const winnerUsername =\n        gameWinner === playerSymbol ? username! : opponent!;\n      setWinner(winnerUsername === username ? \"You win!\" : `${opponent} wins!`);\n      handlePVPMatchResult(winnerUsername);\n      stopPollingMatchState();\n      stopPollingTimeout();\n      setIsTimerActive(false);\n    } else if (isBoardFull(newBoard)) {\n      setIsDraw(true);\n      handlePVPMatchResult(\"draw\");\n      stopPollingMatchState();\n      stopPollingTimeout();\n      setIsTimerActive(false);\n    }\n  };\n\n  const syncMove = async (row: number, col: number) => {\n    if (!matchId || !username) {\n      setIsLoading(false);\n      return;\n    }\n\n    try {\n      const response = await fetch(\n        \"https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/match/move\",\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`,\n          },\n          body: JSON.stringify({\n            matchId,\n            player: username,\n            move: { row, column: col },\n          }),\n        },\n      );\n\n      const data = await response.json();\n\n      if (response.ok) {\n        fetchMatchState();\n      } else {\n        console.error(\"Error syncing move:\", data);\n        alert(data.error || \"Error syncing move\");\n      }\n    } catch (error) {\n      console.error(\"Error syncing move:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleMatchTimeout = async () => {\n    if (!matchId || !username) return;\n\n    try {\n      const response = await fetch(\n        \"https://tic-tac-toe-fullstack-game.onrender.com/leaderboard/match/timeout\",\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${sessionStorage.getItem(\"token\")}`,\n          },\n          body: JSON.stringify({\n            matchId,\n            player: username,\n          }),\n        },\n      );\n\n      const data = await response.json();\n\n      if (response.ok) {\n        if (data.winner) {\n          setWinner(\n            data.winner === null\n              ? \"Match ended due to timeout - Please try again\"\n              : data.winner === username\n                ? \"You win by timeout!\"\n                : `${opponent} wins by timeout!`,\n          );\n          handlePVPMatchResult(data.winner);\n          stopPollingMatchState();\n          stopPollingTimeout();\n          setIsTimerActive(false);\n        }\n      } else {\n        console.error(\"Error checking timeout:\", data);\n      }\n    } catch (error) {\n      console.error(\"Error checking timeout:\", error);\n    }\n  };\n\n  // Function to start polling for timeout\n  const startPollingTimeout = () => {\n    if (timeoutPollingInterval.current) return;\n    timeoutPollingInterval.current = setInterval(handleMatchTimeout, 5000);\n  };\n\n  const stopPollingTimeout = () => {\n    if (timeoutPollingInterval.current) {\n      clearInterval(timeoutPollingInterval.current);\n      timeoutPollingInterval.current = null;\n    }\n  };\n\n  const startPollingMatchState = () => {\n    if (pollingInterval.current) return;\n    pollingInterval.current = setInterval(fetchMatchState, 2000);\n  };\n\n  const stopPollingMatchState = () => {\n    if (pollingInterval.current) {\n      clearInterval(pollingInterval.current);\n      pollingInterval.current = null;\n    }\n  };\n\n  // Format timeLeft into MM:SS\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60)\n      .toString()\n      .padStart(2, \"0\");\n    const secs = (seconds % 60).toString().padStart(2, \"0\");\n    return `${mins}:${secs}`;\n  };\n\n  // Calculate progress percentage\n  const progressPercentage = (timeLeft / timeLeft) * 100;\n\n  return (\n    <Box\n      sx={{\n        position: \"relative\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        height: \"100%\",\n      }}\n    >\n      {gameMode === \"online\" && !matchId && (\n        <>\n          {isMatchmaking && <CircularProgress sx={{ mb: 2 }} />}\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            onClick={startMatchmaking}\n            sx={{ mb: 2 }}\n            disabled={isMatchmaking}\n          >\n            {isMatchmaking ? \"Searching for opponent...\" : \"Start Matchmaking\"}\n          </Button>\n        </>\n      )}\n\n      {/* New Labels */}\n      {(gameMode !== \"online\" || opponent) && (\n        <>\n          <Typography variant=\"h6\" sx={{ fontFamily: \"Poppins\", mt: 2 }}>\n            {gameMode === \"online\" && opponent ? (\n              <>\n                You (\n                <span\n                  style={{\n                    color: playerSymbol === \"X\" ? \"#1976d2\" : \"red\",\n                    fontWeight: \"bold\",\n                  }}\n                >\n                  {playerSymbol}\n                </span>\n                ) vs {opponent} (\n                <span\n                  style={{\n                    color: opponentSymbol === \"X\" ? \"#1976d2\" : \"red\",\n                    fontWeight: \"bold\",\n                  }}\n                >\n                  {opponentSymbol}\n                </span>\n                )\n              </>\n            ) : isAI ? (\n              <>\n                Player (\n                <span style={{ color: \"#1976d2\", fontWeight: \"bold\" }}>X</span>)\n                vs AI (\n                <span style={{ color: \"red\", fontWeight: \"bold\" }}>O</span>)\n              </>\n            ) : (\n              <>\n                Player 1 (\n                <span style={{ color: \"#1976d2\", fontWeight: \"bold\" }}>X</span>)\n                vs Player 2 (\n                <span style={{ color: \"red\", fontWeight: \"bold\" }}>O</span>)\n              </>\n            )}\n          </Typography>\n          <Typography variant=\"h6\" sx={{ fontFamily: \"Poppins\", mt: 2 }}>\n            {winner || isDraw ? (\n              \"Game Over\"\n            ) : gameMode === \"local\" ? (\n              isPlayerTurn ? (\n                <span>\n                  <span style={{ color: \"#1976d2\" }}>X</span>'s Turn\n                </span>\n              ) : (\n                <span>\n                  <span style={{ color: \"red\" }}>O</span>'s Turn\n                </span>\n              )\n            ) : isPlayerTurn ? (\n              \"Your Turn\"\n            ) : gameMode === \"online\" ? (\n              `${opponent}'s Turn`\n            ) : isAI ? (\n              \"AI's Turn\"\n            ) : (\n              \"Opponent's Turn\"\n            )}\n          </Typography>\n\n          {/* Timer with Progress Circle */}\n          {isTimerActive && !winner && !isDraw && (\n            <Box\n              sx={{\n                position: \"relative\",\n                display: \"inline-flex\",\n                mt: 2,\n              }}\n            >\n              <CircularProgress\n                variant=\"determinate\"\n                value={progressPercentage}\n                size={80}\n                thickness={5}\n              />\n              <Box\n                sx={{\n                  top: 0,\n                  left: 0,\n                  bottom: 0,\n                  right: 0,\n                  position: \"absolute\",\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                }}\n              >\n                <Typography variant=\"h6\" component=\"div\" color=\"textSecondary\">\n                  {formatTime(timeLeft)}\n                </Typography>\n              </Box>\n            </Box>\n          )}\n        </>\n      )}\n\n      <Box\n        sx={{\n          display: \"grid\",\n          gridTemplateColumns: `repeat(${boardSize}, 1fr)`,\n          gap: \"1px\",\n          mt: 2,\n        }}\n      >\n        {board.map((row, i) =>\n          row.map((cell, j) => (\n            <Cell\n              key={`${i}-${j}`}\n              value={cell}\n              onClick={() => handleCellClick(i, j)}\n            />\n          )),\n        )}\n      </Box>\n      {winner && (\n        <Typography variant=\"h6\" sx={{ mt: 2 }} color=\"success.main\">\n          {winner}\n        </Typography>\n      )}\n      {isDraw && (\n        <Typography variant=\"h6\" sx={{ mt: 2 }} color=\"warning.main\">\n          It's a draw!\n        </Typography>\n      )}\n\n      <Button\n        variant=\"contained\"\n        color=\"primary\"\n        onClick={configurationBoard}\n        sx={{ margin: 2, fontFamily: \"Poppins\" }}\n      >\n        Back to Configuration\n      </Button>\n\n      <Button\n        variant=\"contained\"\n        color=\"primary\"\n        onClick={resetBoard}\n        sx={{ margin: 2, fontFamily: \"Poppins\" }}\n      >\n        Reset Board\n      </Button>\n\n      {/* Divider */}\n      <div\n        style={{\n          width: \"100%\",\n          borderBottom: \"1px solid #e0e0e0\",\n          margin: \"0 auto 20px\",\n        }}\n      />\n\n      <Typography\n        variant=\"body1\"\n        sx={{ fontFamily: \"Poppins\", margin: \"20px\" }}\n      >\n        Please use a wide screen like a laptop or desktop for the best\n        experience. Thank you for playing Tic Tac Toe Pro today! \n      </Typography>\n\n      {/* Loading Spinner Overlay */}\n      {isLoading && (\n        <Box\n          sx={{\n            position: \"fixed\",\n            top: 0,\n            left: 0,\n            width: \"100%\",\n            height: \"100%\",\n            backgroundColor: \"rgba(128, 128, 128, 0.5)\",\n            zIndex: 9999,\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n          }}\n        >\n          <CircularProgress />\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default Board;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}